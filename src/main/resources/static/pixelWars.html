<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pixel wars</title>
    <style>
        table {
            border-collapse: separate;
            text-indent: initial;
            border-spacing: 0px;
        }
    </style>
</head>
<body>

<table>
    <thead id="anchor">
    </tbody>
</table>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script>
    const UPDATE_INTERVAL_SECONDS = 5;
    const WIDTH = 100;
    const HEIGHT = 47;


    const rgb = {red: 255, green: 0, blue: 100}
    const WHITE = {red: 255, green: 255, blue: 255}
    const RED = {red: 255, green: 0, blue: 0}
    const BLACK = {red: 0, green: 0, blue: 0}
    const GREY = {red: 255, green: 255, blue: 255}
    // let matrix = [
    //     [BLACK, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE],
    //     [WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE],
    //     [WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE],
    //     [WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,RED ,RED ,RED ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE,WHITE, WHITE, WHITE, WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE ,WHITE],
    //
    //    ]
    // let m = matrix;
    let m = Array(HEIGHT).fill(rgb).map(() => Array(WIDTH).fill(rgb))

    redraw(m)
    window.setInterval(tick, UPDATE_INTERVAL_SECONDS * 1000);


    function loadData() {
        let data;
        $.ajax({
            method: 'GET',
            async: false,
            url: 'http://v1570779.hosted-by-vdsina.ru:8080/pixelWars',
            headers: {
                'Access-Control-Allow-Origin': 'http://localhost:8080',
                'Access-Control-Allow-Credentials': 'true'
            },
            data: {
                key: '243b055b2a7a4fffa53205024232103',
                q: "Moscow"
            },
            contentType: 'application/json',
            success: function (response) {
                data = response;
            },
            error: function (e) {

            }
        })
        return data;
    }

    function tick() {
        let test = loadData();
        redraw(m)
    }

    function redraw(matrix) {
        let newTable = "";
        for (let i = 0; i < matrix.length; i++) {
            newTable += "<tr>"
            // $("#anchor").append("<tr>")
            for (let j = 0; j < matrix[i].length; j++) {
                // $(`#anchor`).append(`<th id="pixel${i}_${j}"  style="background-color: rgb(${matrix[i][j].red} ${matrix[i][j].green} ${matrix[i][j].blue}); color: rgb(${matrix[i][j].red} ${matrix[i][j].green} ${matrix[i][j].blue}); "     >12</th>`);
                newTable += `<th id="pixel${i}_${j}"  style="background-color: rgb(${matrix[i][j].red} ${matrix[i][j].green} ${matrix[i][j].blue}); color: rgb(${matrix[i][j].red} ${matrix[i][j].green} ${matrix[i][j].blue}); "     >12</th>`;
            }
            // $("#anchor").append("</tr>")
            newTable += "</tr>"
        }
        $("#anchor").empty()
        $("#anchor").append(newTable)
    }
</script>


</body>
</html>